<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>AStarPathPlanning: upload Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">AStarPathPlanning
   </div>
   <div id="projectbrief">While Acme robot is on automation mode and plan to move from an origin to a goal, this project helps to find the path with the shortest path.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li class="current"><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="namespaces.html"><span>Namespace&#160;List</span></a></li>
      <li><a href="namespacemembers.html"><span>Namespace&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">upload Namespace Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classupload_1_1AbstractRpcServer.html">AbstractRpcServer</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classupload_1_1ClientLoginError.html">ClientLoginError</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classupload_1_1GitVCS.html">GitVCS</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classupload_1_1HttpRpcServer.html">HttpRpcServer</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">elif e.code &gt;= 500 and e.code &lt; 600: </p><h1>Server Error - try again.</h1>
 <a href="classupload_1_1HttpRpcServer.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classupload_1_1MercurialVCS.html">MercurialVCS</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classupload_1_1SubversionVCS.html">SubversionVCS</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classupload_1_1VersionControlSystem.html">VersionControlSystem</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a4f169469a6d43221ebd38cfd546484e1"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceupload.html#a4f169469a6d43221ebd38cfd546484e1">GetEmail</a> (prompt)</td></tr>
<tr class="separator:a4f169469a6d43221ebd38cfd546484e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a79ce84c196c018f3b0c7ff7a9b626b58"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceupload.html#a79ce84c196c018f3b0c7ff7a9b626b58">StatusUpdate</a> (msg)</td></tr>
<tr class="separator:a79ce84c196c018f3b0c7ff7a9b626b58"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adea53186a1d73e92cc839b7c35c2c044"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceupload.html#adea53186a1d73e92cc839b7c35c2c044">ErrorExit</a> (msg)</td></tr>
<tr class="separator:adea53186a1d73e92cc839b7c35c2c044"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1dadef480a702dbc5d0fb66203b9abe7"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceupload.html#a1dadef480a702dbc5d0fb66203b9abe7">GetRpcServer</a> (options)</td></tr>
<tr class="separator:a1dadef480a702dbc5d0fb66203b9abe7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae12985a2c860c124c502dd2099b702eb"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceupload.html#ae12985a2c860c124c502dd2099b702eb">EncodeMultipartFormData</a> (fields, files)</td></tr>
<tr class="separator:ae12985a2c860c124c502dd2099b702eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a753a004706d964335ad218628e07b063"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceupload.html#a753a004706d964335ad218628e07b063">GetContentType</a> (filename)</td></tr>
<tr class="separator:a753a004706d964335ad218628e07b063"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa542d3a5a4f4fce174a1c23644a9204"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceupload.html#afa542d3a5a4f4fce174a1c23644a9204">RunShellWithReturnCode</a> (command, print_output=False, universal_newlines=True)</td></tr>
<tr class="separator:afa542d3a5a4f4fce174a1c23644a9204"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adddc423c49132e8879cbb25d6be2cf11"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceupload.html#adddc423c49132e8879cbb25d6be2cf11">RunShell</a> (command, silent_ok=False, universal_newlines=True, print_output=False)</td></tr>
<tr class="separator:adddc423c49132e8879cbb25d6be2cf11"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9dd260785ca4cc97e245234811ef1949"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceupload.html#a9dd260785ca4cc97e245234811ef1949">SplitPatch</a> (data)</td></tr>
<tr class="separator:a9dd260785ca4cc97e245234811ef1949"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7ec83cb7f7bfb9109c19b6f91552b3ee"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceupload.html#a7ec83cb7f7bfb9109c19b6f91552b3ee">UploadSeparatePatches</a> (issue, rpc_server, patchset, data, options)</td></tr>
<tr class="separator:a7ec83cb7f7bfb9109c19b6f91552b3ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a31390568253accd22ee51861eaeb99bd"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceupload.html#a31390568253accd22ee51861eaeb99bd">GuessVCS</a> (options)</td></tr>
<tr class="separator:a31390568253accd22ee51861eaeb99bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad6226af96c9f1905602b8002bd5de952"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceupload.html#ad6226af96c9f1905602b8002bd5de952">RealMain</a> (argv, data=None)</td></tr>
<tr class="separator:ad6226af96c9f1905602b8002bd5de952"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef3fcf7a8d77d13ba75adbf58b6c43ee"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceupload.html#aef3fcf7a8d77d13ba75adbf58b6c43ee">main</a> ()</td></tr>
<tr class="separator:aef3fcf7a8d77d13ba75adbf58b6c43ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a79aff46409a98c4e5f608c8df1fd4612"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceupload.html#a79aff46409a98c4e5f608c8df1fd4612">verbosity</a> = 1</td></tr>
<tr class="separator:a79aff46409a98c4e5f608c8df1fd4612"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad5b1a43823e2a710a2f78e33dde8901"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceupload.html#aad5b1a43823e2a710a2f78e33dde8901">MAX_UPLOAD_SIZE</a> = 900</td></tr>
<tr class="separator:aad5b1a43823e2a710a2f78e33dde8901"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af9e508d19dc2dd9cdb7c642dde0bdd21"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceupload.html#af9e508d19dc2dd9cdb7c642dde0bdd21">parser</a> = optparse.OptionParser(usage=&quot;%prog [options] [-- diff_options]&quot;)</td></tr>
<tr class="separator:af9e508d19dc2dd9cdb7c642dde0bdd21"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a675d13c979f1c720866d22ed1736f580"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceupload.html#a675d13c979f1c720866d22ed1736f580">action</a></td></tr>
<tr class="separator:a675d13c979f1c720866d22ed1736f580"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a770d9c7b49b1fede80de6078d5e49af7"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceupload.html#a770d9c7b49b1fede80de6078d5e49af7">dest</a></td></tr>
<tr class="separator:a770d9c7b49b1fede80de6078d5e49af7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af4be925d9a50d5ad134d86400509d0f2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceupload.html#af4be925d9a50d5ad134d86400509d0f2">default</a></td></tr>
<tr class="separator:af4be925d9a50d5ad134d86400509d0f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abfc23c9aa2d9b777678da117a85929a5"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceupload.html#abfc23c9aa2d9b777678da117a85929a5">help</a></td></tr>
<tr class="separator:abfc23c9aa2d9b777678da117a85929a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9d33d66de17175dced88ffe95f079226"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceupload.html#a9d33d66de17175dced88ffe95f079226">group</a> = parser.add_option_group(&quot;Logging options&quot;)</td></tr>
<tr class="separator:a9d33d66de17175dced88ffe95f079226"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a985aa9a71de3eb507344df65700c696d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceupload.html#a985aa9a71de3eb507344df65700c696d">const</a></td></tr>
<tr class="separator:a985aa9a71de3eb507344df65700c696d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af1cea8af5389f0ab2d8b65b2c0fd2fe0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceupload.html#af1cea8af5389f0ab2d8b65b2c0fd2fe0">metavar</a></td></tr>
<tr class="separator:af1cea8af5389f0ab2d8b65b2c0fd2fe0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4fc56f0dd6613be15c3c4dc3af3619ce"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceupload.html#a4fc56f0dd6613be15c3c4dc3af3619ce">type</a></td></tr>
<tr class="separator:a4fc56f0dd6613be15c3c4dc3af3619ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa85ceef00a65cd276a856404eb5f310"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceupload.html#afa85ceef00a65cd276a856404eb5f310">use_shell</a> = sys.platform.startswith(&quot;win&quot;)</td></tr>
<tr class="separator:afa85ceef00a65cd276a856404eb5f310"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ae12985a2c860c124c502dd2099b702eb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def upload.EncodeMultipartFormData </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>fields</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>files</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Encode form fields for multipart/form-data.

Args:
  fields: A sequence of (name, value) elements for regular form fields.
  files: A sequence of (name, filename, value) elements for data to be
         uploaded as files.
Returns:
  (content_type, body) ready for httplib.HTTP instance.

Source:
  http://aspn.activestate.com/ASPN/Cookbook/Python/Recipe/146306
</pre> <div class="fragment"><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;<span class="keyword">def </span><a class="code" href="namespaceupload.html#ae12985a2c860c124c502dd2099b702eb">EncodeMultipartFormData</a>(fields, files):</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;  <span class="stringliteral">&quot;&quot;&quot;Encode form fields for multipart/form-data.</span></div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;<span class="stringliteral">  Args:</span></div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;<span class="stringliteral">    fields: A sequence of (name, value) elements for regular form fields.</span></div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;<span class="stringliteral">    files: A sequence of (name, filename, value) elements for data to be</span></div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;<span class="stringliteral">           uploaded as files.</span></div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;<span class="stringliteral">  Returns:</span></div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;<span class="stringliteral">    (content_type, body) ready for httplib.HTTP instance.</span></div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;<span class="stringliteral">  Source:</span></div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;<span class="stringliteral">    http://aspn.activestate.com/ASPN/Cookbook/Python/Recipe/146306</span></div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;<span class="stringliteral">  &quot;&quot;&quot;</span></div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;  BOUNDARY = <span class="stringliteral">&#39;-M-A-G-I-C---B-O-U-N-D-A-R-Y-&#39;</span></div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;  CRLF = <span class="stringliteral">&#39;\r\n&#39;</span></div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;  lines = []</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;  <span class="keywordflow">for</span> (key, value) <span class="keywordflow">in</span> fields:</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    lines.append(<span class="stringliteral">&#39;--&#39;</span> + BOUNDARY)</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    lines.append(<span class="stringliteral">&#39;Content-Disposition: form-data; name=&quot;%s&quot;&#39;</span> % key)</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;    lines.append(<span class="stringliteral">&#39;&#39;</span>)</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    lines.append(value)</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;  <span class="keywordflow">for</span> (key, filename, value) <span class="keywordflow">in</span> files:</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    lines.append(<span class="stringliteral">&#39;--&#39;</span> + BOUNDARY)</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;    lines.append(<span class="stringliteral">&#39;Content-Disposition: form-data; name=&quot;%s&quot;; filename=&quot;%s&quot;&#39;</span> %</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;             (key, filename))</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;    lines.append(<span class="stringliteral">&#39;Content-Type: %s&#39;</span> % <a class="code" href="namespaceupload.html#a753a004706d964335ad218628e07b063">GetContentType</a>(filename))</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;    lines.append(<span class="stringliteral">&#39;&#39;</span>)</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;    lines.append(value)</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;  lines.append(<span class="stringliteral">&#39;--&#39;</span> + BOUNDARY + <span class="stringliteral">&#39;--&#39;</span>)</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;  lines.append(<span class="stringliteral">&#39;&#39;</span>)</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;  body = CRLF.join(lines)</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;  content_type = <span class="stringliteral">&#39;multipart/form-data; boundary=%s&#39;</span> % BOUNDARY</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;  <span class="keywordflow">return</span> content_type, body</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;</div><div class="ttc" id="namespaceupload_html_ae12985a2c860c124c502dd2099b702eb"><div class="ttname"><a href="namespaceupload.html#ae12985a2c860c124c502dd2099b702eb">upload.EncodeMultipartFormData</a></div><div class="ttdeci">def EncodeMultipartFormData(fields, files)</div><div class="ttdef"><b>Definition:</b> upload.py:498</div></div>
<div class="ttc" id="namespaceupload_html_a753a004706d964335ad218628e07b063"><div class="ttname"><a href="namespaceupload.html#a753a004706d964335ad218628e07b063">upload.GetContentType</a></div><div class="ttdeci">def GetContentType(filename)</div><div class="ttdef"><b>Definition:</b> upload.py:533</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="adea53186a1d73e92cc839b7c35c2c044"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def upload.ErrorExit </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>msg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Print an error message to stderr and exit.</pre> <div class="fragment"><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="keyword">def </span><a class="code" href="namespaceupload.html#adea53186a1d73e92cc839b7c35c2c044">ErrorExit</a>(msg):</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  <span class="stringliteral">&quot;&quot;&quot;Print an error message to stderr and exit.&quot;&quot;&quot;</span></div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  <span class="keywordflow">print</span> &gt;&gt;sys.stderr, msg</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  sys.exit(1)</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;</div><div class="ttc" id="namespaceupload_html_adea53186a1d73e92cc839b7c35c2c044"><div class="ttname"><a href="namespaceupload.html#adea53186a1d73e92cc839b7c35c2c044">upload.ErrorExit</a></div><div class="ttdeci">def ErrorExit(msg)</div><div class="ttdef"><b>Definition:</b> upload.py:109</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a753a004706d964335ad218628e07b063"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def upload.GetContentType </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>filename</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Helper to guess the content-type from the filename.</pre> <div class="fragment"><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;<span class="keyword">def </span><a class="code" href="namespaceupload.html#a753a004706d964335ad218628e07b063">GetContentType</a>(filename):</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;  <span class="stringliteral">&quot;&quot;&quot;Helper to guess the content-type from the filename.&quot;&quot;&quot;</span></div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;  <span class="keywordflow">return</span> mimetypes.guess_type(filename)[0] <span class="keywordflow">or</span> <span class="stringliteral">&#39;application/octet-stream&#39;</span></div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;<span class="comment"># Use a shell for subcommands on Windows to get a PATH search.</span></div><div class="ttc" id="namespaceupload_html_a753a004706d964335ad218628e07b063"><div class="ttname"><a href="namespaceupload.html#a753a004706d964335ad218628e07b063">upload.GetContentType</a></div><div class="ttdeci">def GetContentType(filename)</div><div class="ttdef"><b>Definition:</b> upload.py:533</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a4f169469a6d43221ebd38cfd546484e1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def upload.GetEmail </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>prompt</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Prompts the user for their email address and returns it.

The last used email address is saved to a file and offered up as a suggestion
to the user. If the user presses enter without typing in anything the last
used email address is used. If the user enters a new address, it is saved
for next time we prompt.</pre> <div class="fragment"><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="keyword">def </span><a class="code" href="namespaceupload.html#a4f169469a6d43221ebd38cfd546484e1">GetEmail</a>(prompt):</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  <span class="stringliteral">&quot;&quot;&quot;Prompts the user for their email address and returns it.</span></div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="stringliteral">  The last used email address is saved to a file and offered up as a suggestion</span></div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="stringliteral">  to the user. If the user presses enter without typing in anything the last</span></div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="stringliteral">  used email address is used. If the user enters a new address, it is saved</span></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="stringliteral">  for next time we prompt.</span></div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="stringliteral">  &quot;&quot;&quot;</span></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  last_email_file_name = os.path.expanduser(<span class="stringliteral">&quot;~/.last_codereview_email_address&quot;</span>)</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  last_email = <span class="stringliteral">&quot;&quot;</span></div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  <span class="keywordflow">if</span> os.path.exists(last_email_file_name):</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <span class="keywordflow">try</span>:</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;      last_email_file = open(last_email_file_name, <span class="stringliteral">&quot;r&quot;)</span></div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="stringliteral">      last_email = last_email_file.readline().strip(&quot;\n&quot;</span>)</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;      last_email_file.close()</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;      prompt += <span class="stringliteral">&quot; [%s]&quot;</span> % last_email</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <span class="keywordflow">except</span> IOError, e:</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;      <span class="keywordflow">pass</span></div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  email = raw_input(prompt + <span class="stringliteral">&quot;: &quot;</span>).strip()</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  <span class="keywordflow">if</span> email:</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <span class="keywordflow">try</span>:</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;      last_email_file = open(last_email_file_name, <span class="stringliteral">&quot;w&quot;</span>)</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;      last_email_file.write(email)</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;      last_email_file.close()</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <span class="keywordflow">except</span> IOError, e:</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;      <span class="keywordflow">pass</span></div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  <span class="keywordflow">else</span>:</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    email = last_email</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  <span class="keywordflow">return</span> email</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;</div><div class="ttc" id="namespaceupload_html_a4f169469a6d43221ebd38cfd546484e1"><div class="ttname"><a href="namespaceupload.html#a4f169469a6d43221ebd38cfd546484e1">upload.GetEmail</a></div><div class="ttdeci">def GetEmail(prompt)</div><div class="ttdef"><b>Definition:</b> upload.py:65</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a1dadef480a702dbc5d0fb66203b9abe7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def upload.GetRpcServer </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>options</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Returns an instance of an AbstractRpcServer.

Returns:
  A new AbstractRpcServer, on which RPC calls can be made.
</pre> <div class="fragment"><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;<span class="keyword">def </span><a class="code" href="namespaceupload.html#a1dadef480a702dbc5d0fb66203b9abe7">GetRpcServer</a>(options):</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;  <span class="stringliteral">&quot;&quot;&quot;Returns an instance of an AbstractRpcServer.</span></div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;<span class="stringliteral">  Returns:</span></div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;<span class="stringliteral">    A new AbstractRpcServer, on which RPC calls can be made.</span></div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;<span class="stringliteral">  &quot;&quot;&quot;</span></div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;  rpc_server_class = HttpRpcServer</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;  <span class="keyword">def </span>GetUserCredentials():</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    <span class="stringliteral">&quot;&quot;&quot;Prompts the user for a username and password.&quot;&quot;&quot;</span></div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    email = options.email</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;    <span class="keywordflow">if</span> email <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;      email = <a class="code" href="namespaceupload.html#a4f169469a6d43221ebd38cfd546484e1">GetEmail</a>(<span class="stringliteral">&quot;Email (login for uploading to %s)&quot;</span> % options.server)</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    password = getpass.getpass(<span class="stringliteral">&quot;Password for %s: &quot;</span> % email)</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    <span class="keywordflow">return</span> (email, password)</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;  <span class="comment"># If this is the dev_appserver, use fake authentication.</span></div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;  host = (options.host <span class="keywordflow">or</span> options.server).lower()</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;  <span class="keywordflow">if</span> host == <span class="stringliteral">&quot;localhost&quot;</span> <span class="keywordflow">or</span> host.startswith(<span class="stringliteral">&quot;localhost:&quot;</span>):</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    email = options.email</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    <span class="keywordflow">if</span> email <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;      email = <span class="stringliteral">&quot;test@example.com&quot;</span></div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;      logging.info(<span class="stringliteral">&quot;Using debug user %s.  Override with --email&quot;</span> % email)</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    server = rpc_server_class(</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;        options.server,</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;        <span class="keyword">lambda</span>: (email, <span class="stringliteral">&quot;password&quot;</span>),</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;        host_override=options.host,</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;        extra_headers={<span class="stringliteral">&quot;Cookie&quot;</span>:</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;                       <span class="stringliteral">&#39;dev_appserver_login=&quot;%s:False&quot;&#39;</span> % email},</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;        save_cookies=options.save_cookies)</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    <span class="comment"># Don&#39;t try to talk to ClientLogin.</span></div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    server.authenticated = <span class="keyword">True</span></div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    <span class="keywordflow">return</span> server</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;  <span class="keywordflow">return</span> rpc_server_class(options.server, GetUserCredentials,</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;                          host_override=options.host,</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;                          save_cookies=options.save_cookies)</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;</div><div class="ttc" id="namespaceupload_html_a1dadef480a702dbc5d0fb66203b9abe7"><div class="ttname"><a href="namespaceupload.html#a1dadef480a702dbc5d0fb66203b9abe7">upload.GetRpcServer</a></div><div class="ttdeci">def GetRpcServer(options)</div><div class="ttdef"><b>Definition:</b> upload.py:458</div></div>
<div class="ttc" id="namespaceupload_html_a4f169469a6d43221ebd38cfd546484e1"><div class="ttname"><a href="namespaceupload.html#a4f169469a6d43221ebd38cfd546484e1">upload.GetEmail</a></div><div class="ttdeci">def GetEmail(prompt)</div><div class="ttdef"><b>Definition:</b> upload.py:65</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a31390568253accd22ee51861eaeb99bd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def upload.GuessVCS </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>options</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Helper to guess the version control system.

This examines the current directory, guesses which VersionControlSystem
we're using, and returns an instance of the appropriate class.  Exit with an
error if we can't figure it out.

Returns:
  A VersionControlSystem instance. Exits if the VCS can't be guessed.
</pre> <div class="fragment"><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;<span class="keyword">def </span><a class="code" href="namespaceupload.html#a31390568253accd22ee51861eaeb99bd">GuessVCS</a>(options):</div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;  <span class="stringliteral">&quot;&quot;&quot;Helper to guess the version control system.</span></div><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;<span class="stringliteral">  This examines the current directory, guesses which VersionControlSystem</span></div><div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;<span class="stringliteral">  we&#39;re using, and returns an instance of the appropriate class.  Exit with an</span></div><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;<span class="stringliteral">  error if we can&#39;t figure it out.</span></div><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;<span class="stringliteral">  Returns:</span></div><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;<span class="stringliteral">    A VersionControlSystem instance. Exits if the VCS can&#39;t be guessed.</span></div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;<span class="stringliteral">  &quot;&quot;&quot;</span></div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;  <span class="comment"># Mercurial has a command to get the base directory of a repository</span></div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;  <span class="comment"># Try running it, but don&#39;t die if we don&#39;t have hg installed.</span></div><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;  <span class="comment"># NOTE: we try Mercurial first as it can sit on top of an SVN working copy.</span></div><div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;  <span class="keywordflow">try</span>:</div><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;    out, returncode = <a class="code" href="namespaceupload.html#afa542d3a5a4f4fce174a1c23644a9204">RunShellWithReturnCode</a>([<span class="stringliteral">&quot;hg&quot;</span>, <span class="stringliteral">&quot;root&quot;</span>])</div><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;    <span class="keywordflow">if</span> returncode == 0:</div><div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;      <span class="keywordflow">return</span> MercurialVCS(options, out.strip())</div><div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;  <span class="keywordflow">except</span> OSError, (errno, message):</div><div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;    <span class="keywordflow">if</span> errno != 2:  <span class="comment"># ENOENT -- they don&#39;t have hg installed.</span></div><div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;      <span class="keywordflow">raise</span></div><div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;</div><div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;  <span class="comment"># Subversion has a .svn in all working directories.</span></div><div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;  <span class="keywordflow">if</span> os.path.isdir(<span class="stringliteral">&#39;.svn&#39;</span>):</div><div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;    logging.info(<span class="stringliteral">&quot;Guessed VCS = Subversion&quot;</span>)</div><div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;    <span class="keywordflow">return</span> SubversionVCS(options)</div><div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;</div><div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;  <span class="comment"># Git has a command to test if you&#39;re in a git tree.</span></div><div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;  <span class="comment"># Try running it, but don&#39;t die if we don&#39;t have git installed.</span></div><div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;  <span class="keywordflow">try</span>:</div><div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;    out, returncode = <a class="code" href="namespaceupload.html#afa542d3a5a4f4fce174a1c23644a9204">RunShellWithReturnCode</a>([<span class="stringliteral">&quot;git&quot;</span>, <span class="stringliteral">&quot;rev-parse&quot;</span>,</div><div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;                                              <span class="stringliteral">&quot;--is-inside-work-tree&quot;</span>])</div><div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;    <span class="keywordflow">if</span> returncode == 0:</div><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;      <span class="keywordflow">return</span> GitVCS(options)</div><div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;  <span class="keywordflow">except</span> OSError, (errno, message):</div><div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;    <span class="keywordflow">if</span> errno != 2:  <span class="comment"># ENOENT -- they don&#39;t have git installed.</span></div><div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;      <span class="keywordflow">raise</span></div><div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;</div><div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;  <a class="code" href="namespaceupload.html#adea53186a1d73e92cc839b7c35c2c044">ErrorExit</a>((<span class="stringliteral">&quot;Could not guess version control system. &quot;</span></div><div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;             <span class="stringliteral">&quot;Are you in a working copy directory?&quot;</span>))</div><div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;</div><div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;</div><div class="ttc" id="namespaceupload_html_adea53186a1d73e92cc839b7c35c2c044"><div class="ttname"><a href="namespaceupload.html#adea53186a1d73e92cc839b7c35c2c044">upload.ErrorExit</a></div><div class="ttdeci">def ErrorExit(msg)</div><div class="ttdef"><b>Definition:</b> upload.py:109</div></div>
<div class="ttc" id="namespaceupload_html_a31390568253accd22ee51861eaeb99bd"><div class="ttname"><a href="namespaceupload.html#a31390568253accd22ee51861eaeb99bd">upload.GuessVCS</a></div><div class="ttdeci">def GuessVCS(options)</div><div class="ttdef"><b>Definition:</b> upload.py:1209</div></div>
<div class="ttc" id="namespaceupload_html_afa542d3a5a4f4fce174a1c23644a9204"><div class="ttname"><a href="namespaceupload.html#afa542d3a5a4f4fce174a1c23644a9204">upload.RunShellWithReturnCode</a></div><div class="ttdeci">def RunShellWithReturnCode(command, print_output=False, universal_newlines=True)</div><div class="ttdef"><b>Definition:</b> upload.py:542</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aef3fcf7a8d77d13ba75adbf58b6c43ee"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def upload.main </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;<span class="keyword">def </span><a class="code" href="namespacerelease__docs.html#ac4eb92814ebe701e3936d1bfdd2ecf73">main</a>():</div><div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;  <span class="keywordflow">try</span>:</div><div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;    <a class="code" href="namespaceupload.html#ad6226af96c9f1905602b8002bd5de952">RealMain</a>(sys.argv)</div><div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;  <span class="keywordflow">except</span> KeyboardInterrupt:</div><div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;    <span class="keywordflow">print</span></div><div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;    <a class="code" href="namespaceupload.html#a79ce84c196c018f3b0c7ff7a9b626b58">StatusUpdate</a>(<span class="stringliteral">&quot;Interrupted.&quot;</span>)</div><div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;    sys.exit(1)</div><div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;</div><div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;</div><div class="ttc" id="namespacerelease__docs_html_ac4eb92814ebe701e3936d1bfdd2ecf73"><div class="ttname"><a href="namespacerelease__docs.html#ac4eb92814ebe701e3936d1bfdd2ecf73">release_docs.main</a></div><div class="ttdeci">def main()</div><div class="ttdef"><b>Definition:</b> release_docs.py:148</div></div>
<div class="ttc" id="namespaceupload_html_ad6226af96c9f1905602b8002bd5de952"><div class="ttname"><a href="namespaceupload.html#ad6226af96c9f1905602b8002bd5de952">upload.RealMain</a></div><div class="ttdeci">def RealMain(argv, data=None)</div><div class="ttdef"><b>Definition:</b> upload.py:1250</div></div>
<div class="ttc" id="namespaceupload_html_a79ce84c196c018f3b0c7ff7a9b626b58"><div class="ttname"><a href="namespaceupload.html#a79ce84c196c018f3b0c7ff7a9b626b58">upload.StatusUpdate</a></div><div class="ttdeci">def StatusUpdate(msg)</div><div class="ttdef"><b>Definition:</b> upload.py:97</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ad6226af96c9f1905602b8002bd5de952"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def upload.RealMain </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>argv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>data</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">The real main function.

Args:
  argv: Command line arguments.
  data: Diff contents. If None (default) the diff is generated by
    the VersionControlSystem implementation returned by GuessVCS().

Returns:
  A 2-tuple (issue id, patchset id).
  The patchset id is None if the base files are not uploaded by this
  script (applies only to SVN checkouts).
</pre> <div class="fragment"><div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;<span class="keyword">def </span><a class="code" href="namespaceupload.html#ad6226af96c9f1905602b8002bd5de952">RealMain</a>(argv, data=None):</div><div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;  <span class="stringliteral">&quot;&quot;&quot;The real main function.</span></div><div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;<span class="stringliteral">  Args:</span></div><div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;<span class="stringliteral">    argv: Command line arguments.</span></div><div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;<span class="stringliteral">    data: Diff contents. If None (default) the diff is generated by</span></div><div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;<span class="stringliteral">      the VersionControlSystem implementation returned by GuessVCS().</span></div><div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;<span class="stringliteral">  Returns:</span></div><div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;<span class="stringliteral">    A 2-tuple (issue id, patchset id).</span></div><div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;<span class="stringliteral">    The patchset id is None if the base files are not uploaded by this</span></div><div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;<span class="stringliteral">    script (applies only to SVN checkouts).</span></div><div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;<span class="stringliteral">  &quot;&quot;&quot;</span></div><div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;  logging.basicConfig(format=(<span class="stringliteral">&quot;%(asctime).19s %(levelname)s %(filename)s:&quot;</span></div><div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;                              <span class="stringliteral">&quot;%(lineno)s %(message)s &quot;</span>))</div><div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;  os.environ[<span class="stringliteral">&#39;LC_ALL&#39;</span>] = <span class="stringliteral">&#39;C&#39;</span></div><div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;  options, args = parser.parse_args(argv[1:])</div><div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;  <span class="keyword">global</span> verbosity</div><div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;  verbosity = options.verbose</div><div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;  <span class="keywordflow">if</span> verbosity &gt;= 3:</div><div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;    logging.getLogger().setLevel(logging.DEBUG)</div><div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;  <span class="keywordflow">elif</span> verbosity &gt;= 2:</div><div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;    logging.getLogger().setLevel(logging.INFO)</div><div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;  vcs = <a class="code" href="namespaceupload.html#a31390568253accd22ee51861eaeb99bd">GuessVCS</a>(options)</div><div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;  <span class="keywordflow">if</span> isinstance(vcs, SubversionVCS):</div><div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;    <span class="comment"># base field is only allowed for Subversion.</span></div><div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;    <span class="comment"># Note: Fetching base files may become deprecated in future releases.</span></div><div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;    base = vcs.GuessBase(options.download_base)</div><div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;  <span class="keywordflow">else</span>:</div><div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;    base = <span class="keywordtype">None</span></div><div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;  <span class="keywordflow">if</span> <span class="keywordflow">not</span> base <span class="keywordflow">and</span> options.download_base:</div><div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;    options.download_base = <span class="keyword">True</span></div><div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;    logging.info(<span class="stringliteral">&quot;Enabled upload of base file&quot;</span>)</div><div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;  <span class="keywordflow">if</span> <span class="keywordflow">not</span> options.assume_yes:</div><div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;    vcs.CheckForUnknownFiles()</div><div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;  <span class="keywordflow">if</span> data <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div><div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;    data = vcs.GenerateDiff(args)</div><div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;  files = vcs.GetBaseFiles(data)</div><div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;  <span class="keywordflow">if</span> verbosity &gt;= 1:</div><div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;    <span class="keywordflow">print</span> <span class="stringliteral">&quot;Upload server:&quot;</span>, options.server, <span class="stringliteral">&quot;(change with -s/--server)&quot;</span></div><div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;  <span class="keywordflow">if</span> options.issue:</div><div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;    prompt = <span class="stringliteral">&quot;Message describing this patch set: &quot;</span></div><div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;  <span class="keywordflow">else</span>:</div><div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;    prompt = <span class="stringliteral">&quot;New issue subject: &quot;</span></div><div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;  message = options.message <span class="keywordflow">or</span> raw_input(prompt).strip()</div><div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;  <span class="keywordflow">if</span> <span class="keywordflow">not</span> message:</div><div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;    <a class="code" href="namespaceupload.html#adea53186a1d73e92cc839b7c35c2c044">ErrorExit</a>(<span class="stringliteral">&quot;A non-empty message is required&quot;</span>)</div><div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;  rpc_server = <a class="code" href="namespaceupload.html#a1dadef480a702dbc5d0fb66203b9abe7">GetRpcServer</a>(options)</div><div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;  form_fields = [(<span class="stringliteral">&quot;subject&quot;</span>, message)]</div><div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;  <span class="keywordflow">if</span> base:</div><div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;    form_fields.append((<span class="stringliteral">&quot;base&quot;</span>, base))</div><div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;  <span class="keywordflow">if</span> options.issue:</div><div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;    form_fields.append((<span class="stringliteral">&quot;issue&quot;</span>, str(options.issue)))</div><div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;  <span class="keywordflow">if</span> options.email:</div><div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;    form_fields.append((<span class="stringliteral">&quot;user&quot;</span>, options.email))</div><div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;  <span class="keywordflow">if</span> options.reviewers:</div><div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;    <span class="keywordflow">for</span> reviewer <span class="keywordflow">in</span> options.reviewers.split(<span class="stringliteral">&#39;,&#39;</span>):</div><div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;      <span class="keywordflow">if</span> <span class="stringliteral">&quot;@&quot;</span> <span class="keywordflow">in</span> reviewer <span class="keywordflow">and</span> <span class="keywordflow">not</span> reviewer.split(<span class="stringliteral">&quot;@&quot;</span>)[1].<a class="code" href="gmock__stress__test_8cc.html#afd9db40e3361ae09188795e8cbe19752">count</a>(<span class="stringliteral">&quot;.&quot;</span>) == 1:</div><div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;        <a class="code" href="namespaceupload.html#adea53186a1d73e92cc839b7c35c2c044">ErrorExit</a>(<span class="stringliteral">&quot;Invalid email address: %s&quot;</span> % reviewer)</div><div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;    form_fields.append((<span class="stringliteral">&quot;reviewers&quot;</span>, options.reviewers))</div><div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;  <span class="keywordflow">if</span> options.cc:</div><div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;    <span class="keywordflow">for</span> cc <span class="keywordflow">in</span> options.cc.split(<span class="stringliteral">&#39;,&#39;</span>):</div><div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;      <span class="keywordflow">if</span> <span class="stringliteral">&quot;@&quot;</span> <span class="keywordflow">in</span> cc <span class="keywordflow">and</span> <span class="keywordflow">not</span> cc.split(<span class="stringliteral">&quot;@&quot;</span>)[1].<a class="code" href="gmock__stress__test_8cc.html#afd9db40e3361ae09188795e8cbe19752">count</a>(<span class="stringliteral">&quot;.&quot;</span>) == 1:</div><div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;        <a class="code" href="namespaceupload.html#adea53186a1d73e92cc839b7c35c2c044">ErrorExit</a>(<span class="stringliteral">&quot;Invalid email address: %s&quot;</span> % cc)</div><div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;    form_fields.append((<span class="stringliteral">&quot;cc&quot;</span>, options.cc))</div><div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;  description = options.description</div><div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;  <span class="keywordflow">if</span> options.description_file:</div><div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;    <span class="keywordflow">if</span> options.description:</div><div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;      <a class="code" href="namespaceupload.html#adea53186a1d73e92cc839b7c35c2c044">ErrorExit</a>(<span class="stringliteral">&quot;Can&#39;t specify description and description_file&quot;</span>)</div><div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;    file = open(options.description_file, <span class="stringliteral">&#39;r&#39;)</span></div><div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;<span class="stringliteral">    description = file.read()</span></div><div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;<span class="stringliteral">    file.close()</span></div><div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;<span class="stringliteral">  </span><span class="keywordflow">if</span> description:</div><div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;    form_fields.append((<span class="stringliteral">&quot;description&quot;</span>, description))</div><div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;  <span class="comment"># Send a hash of all the base file so the server can determine if a copy</span></div><div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;  <span class="comment"># already exists in an earlier patchset.</span></div><div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;  base_hashes = <span class="stringliteral">&quot;&quot;</span></div><div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;  <span class="keywordflow">for</span> file, info <span class="keywordflow">in</span> files.iteritems():</div><div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;    <span class="keywordflow">if</span> <span class="keywordflow">not</span> info[0] <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div><div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;      checksum = md5.new(info[0]).hexdigest()</div><div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;      <span class="keywordflow">if</span> base_hashes:</div><div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;        base_hashes += <span class="stringliteral">&quot;|&quot;</span></div><div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;      base_hashes += checksum + <span class="stringliteral">&quot;:&quot;</span> + file</div><div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;  form_fields.append((<span class="stringliteral">&quot;base_hashes&quot;</span>, base_hashes))</div><div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;  <span class="comment"># If we&#39;re uploading base files, don&#39;t send the email before the uploads, so</span></div><div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;  <span class="comment"># that it contains the file status.</span></div><div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;  <span class="keywordflow">if</span> options.send_mail <span class="keywordflow">and</span> options.download_base:</div><div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;    form_fields.append((<span class="stringliteral">&quot;send_mail&quot;</span>, <span class="stringliteral">&quot;1&quot;</span>))</div><div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;  <span class="keywordflow">if</span> <span class="keywordflow">not</span> options.download_base:</div><div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;    form_fields.append((<span class="stringliteral">&quot;content_upload&quot;</span>, <span class="stringliteral">&quot;1&quot;</span>))</div><div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;  <span class="keywordflow">if</span> len(data) &gt; MAX_UPLOAD_SIZE:</div><div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;    <span class="keywordflow">print</span> <span class="stringliteral">&quot;Patch is large, so uploading file patches separately.&quot;</span></div><div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;    uploaded_diff_file = []</div><div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;    form_fields.append((<span class="stringliteral">&quot;separate_patches&quot;</span>, <span class="stringliteral">&quot;1&quot;</span>))</div><div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;  <span class="keywordflow">else</span>:</div><div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;    uploaded_diff_file = [(<span class="stringliteral">&quot;data&quot;</span>, <span class="stringliteral">&quot;data.diff&quot;</span>, data)]</div><div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;  ctype, body = <a class="code" href="namespaceupload.html#ae12985a2c860c124c502dd2099b702eb">EncodeMultipartFormData</a>(form_fields, uploaded_diff_file)</div><div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;  response_body = rpc_server.Send(<span class="stringliteral">&quot;/upload&quot;</span>, body, content_type=ctype)</div><div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;  patchset = <span class="keywordtype">None</span></div><div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;  <span class="keywordflow">if</span> <span class="keywordflow">not</span> options.download_base <span class="keywordflow">or</span> <span class="keywordflow">not</span> uploaded_diff_file:</div><div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;    lines = response_body.splitlines()</div><div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;    <span class="keywordflow">if</span> len(lines) &gt;= 2:</div><div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;      msg = lines[0]</div><div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;      patchset = lines[1].strip()</div><div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;      patches = [x.split(<span class="stringliteral">&quot; &quot;</span>, 1) <span class="keywordflow">for</span> x <span class="keywordflow">in</span> lines[2:]]</div><div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;    <span class="keywordflow">else</span>:</div><div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;      msg = response_body</div><div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;  <span class="keywordflow">else</span>:</div><div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;    msg = response_body</div><div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;  <a class="code" href="namespaceupload.html#a79ce84c196c018f3b0c7ff7a9b626b58">StatusUpdate</a>(msg)</div><div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;  <span class="keywordflow">if</span> <span class="keywordflow">not</span> response_body.startswith(<span class="stringliteral">&quot;Issue created.&quot;</span>) <span class="keywordflow">and</span> \</div><div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;  <span class="keywordflow">not</span> response_body.startswith(<span class="stringliteral">&quot;Issue updated.&quot;</span>):</div><div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;    sys.exit(0)</div><div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;  issue = msg[msg.rfind(<span class="stringliteral">&quot;/&quot;</span>)+1:]</div><div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;</div><div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;  <span class="keywordflow">if</span> <span class="keywordflow">not</span> uploaded_diff_file:</div><div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;    result = <a class="code" href="namespaceupload.html#a7ec83cb7f7bfb9109c19b6f91552b3ee">UploadSeparatePatches</a>(issue, rpc_server, patchset, data, options)</div><div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;    <span class="keywordflow">if</span> <span class="keywordflow">not</span> options.download_base:</div><div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;      patches = result</div><div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;</div><div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;  <span class="keywordflow">if</span> <span class="keywordflow">not</span> options.download_base:</div><div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;    vcs.UploadBaseFiles(issue, rpc_server, patches, patchset, options, files)</div><div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;    <span class="keywordflow">if</span> options.send_mail:</div><div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;      rpc_server.Send(<span class="stringliteral">&quot;/&quot;</span> + issue + <span class="stringliteral">&quot;/mail&quot;</span>, payload=<span class="stringliteral">&quot;&quot;</span>)</div><div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;  <span class="keywordflow">return</span> issue, patchset</div><div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;</div><div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;</div><div class="ttc" id="gmock__stress__test_8cc_html_afd9db40e3361ae09188795e8cbe19752"><div class="ttname"><a href="gmock__stress__test_8cc.html#afd9db40e3361ae09188795e8cbe19752">count</a></div><div class="ttdeci">int * count</div><div class="ttdef"><b>Definition:</b> gmock_stress_test.cc:176</div></div>
<div class="ttc" id="namespaceupload_html_a1dadef480a702dbc5d0fb66203b9abe7"><div class="ttname"><a href="namespaceupload.html#a1dadef480a702dbc5d0fb66203b9abe7">upload.GetRpcServer</a></div><div class="ttdeci">def GetRpcServer(options)</div><div class="ttdef"><b>Definition:</b> upload.py:458</div></div>
<div class="ttc" id="namespaceupload_html_a7ec83cb7f7bfb9109c19b6f91552b3ee"><div class="ttname"><a href="namespaceupload.html#a7ec83cb7f7bfb9109c19b6f91552b3ee">upload.UploadSeparatePatches</a></div><div class="ttdeci">def UploadSeparatePatches(issue, rpc_server, patchset, data, options)</div><div class="ttdef"><b>Definition:</b> upload.py:1181</div></div>
<div class="ttc" id="namespaceupload_html_adea53186a1d73e92cc839b7c35c2c044"><div class="ttname"><a href="namespaceupload.html#adea53186a1d73e92cc839b7c35c2c044">upload.ErrorExit</a></div><div class="ttdeci">def ErrorExit(msg)</div><div class="ttdef"><b>Definition:</b> upload.py:109</div></div>
<div class="ttc" id="namespaceupload_html_ae12985a2c860c124c502dd2099b702eb"><div class="ttname"><a href="namespaceupload.html#ae12985a2c860c124c502dd2099b702eb">upload.EncodeMultipartFormData</a></div><div class="ttdeci">def EncodeMultipartFormData(fields, files)</div><div class="ttdef"><b>Definition:</b> upload.py:498</div></div>
<div class="ttc" id="namespaceupload_html_ad6226af96c9f1905602b8002bd5de952"><div class="ttname"><a href="namespaceupload.html#ad6226af96c9f1905602b8002bd5de952">upload.RealMain</a></div><div class="ttdeci">def RealMain(argv, data=None)</div><div class="ttdef"><b>Definition:</b> upload.py:1250</div></div>
<div class="ttc" id="namespaceupload_html_a79ce84c196c018f3b0c7ff7a9b626b58"><div class="ttname"><a href="namespaceupload.html#a79ce84c196c018f3b0c7ff7a9b626b58">upload.StatusUpdate</a></div><div class="ttdeci">def StatusUpdate(msg)</div><div class="ttdef"><b>Definition:</b> upload.py:97</div></div>
<div class="ttc" id="namespaceupload_html_a31390568253accd22ee51861eaeb99bd"><div class="ttname"><a href="namespaceupload.html#a31390568253accd22ee51861eaeb99bd">upload.GuessVCS</a></div><div class="ttdeci">def GuessVCS(options)</div><div class="ttdef"><b>Definition:</b> upload.py:1209</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="adddc423c49132e8879cbb25d6be2cf11"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def upload.RunShell </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>command</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>silent_ok</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>universal_newlines</em> = <code>True</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>print_output</em> = <code>False</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;             print_output=<span class="keyword">False</span>):</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;  data, retcode = <a class="code" href="namespaceupload.html#afa542d3a5a4f4fce174a1c23644a9204">RunShellWithReturnCode</a>(command, print_output,</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;                                         universal_newlines)</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;  <span class="keywordflow">if</span> retcode:</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;    <a class="code" href="namespaceupload.html#adea53186a1d73e92cc839b7c35c2c044">ErrorExit</a>(<span class="stringliteral">&quot;Got error status from %s:\n%s&quot;</span> % (command, data))</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;  <span class="keywordflow">if</span> <span class="keywordflow">not</span> silent_ok <span class="keywordflow">and</span> <span class="keywordflow">not</span> data:</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;    <a class="code" href="namespaceupload.html#adea53186a1d73e92cc839b7c35c2c044">ErrorExit</a>(<span class="stringliteral">&quot;No output from %s&quot;</span> % command)</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;  <span class="keywordflow">return</span> data</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;</div><div class="ttc" id="namespaceupload_html_adea53186a1d73e92cc839b7c35c2c044"><div class="ttname"><a href="namespaceupload.html#adea53186a1d73e92cc839b7c35c2c044">upload.ErrorExit</a></div><div class="ttdeci">def ErrorExit(msg)</div><div class="ttdef"><b>Definition:</b> upload.py:109</div></div>
<div class="ttc" id="namespaceupload_html_afa542d3a5a4f4fce174a1c23644a9204"><div class="ttname"><a href="namespaceupload.html#afa542d3a5a4f4fce174a1c23644a9204">upload.RunShellWithReturnCode</a></div><div class="ttdeci">def RunShellWithReturnCode(command, print_output=False, universal_newlines=True)</div><div class="ttdef"><b>Definition:</b> upload.py:542</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="afa542d3a5a4f4fce174a1c23644a9204"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def upload.RunShellWithReturnCode </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>command</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>print_output</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>universal_newlines</em> = <code>True</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Executes a command and returns the output from stdout and the return code.

Args:
  command: Command to execute.
  print_output: If True, the output is printed to stdout.
                If False, both stdout and stderr are ignored.
  universal_newlines: Use universal_newlines flag (default: True).

Returns:
  Tuple (output, return code)
</pre> <div class="fragment"><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;                           universal_newlines=<span class="keyword">True</span>):</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;  <span class="stringliteral">&quot;&quot;&quot;Executes a command and returns the output from stdout and the return code.</span></div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;<span class="stringliteral">  Args:</span></div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;<span class="stringliteral">    command: Command to execute.</span></div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;<span class="stringliteral">    print_output: If True, the output is printed to stdout.</span></div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;<span class="stringliteral">                  If False, both stdout and stderr are ignored.</span></div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;<span class="stringliteral">    universal_newlines: Use universal_newlines flag (default: True).</span></div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;<span class="stringliteral">  Returns:</span></div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;<span class="stringliteral">    Tuple (output, return code)</span></div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;<span class="stringliteral">  &quot;&quot;&quot;</span></div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;  logging.info(<span class="stringliteral">&quot;Running %s&quot;</span>, command)</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;  p = subprocess.Popen(command, stdout=subprocess.PIPE, stderr=subprocess.PIPE,</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;                       shell=use_shell, universal_newlines=universal_newlines)</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;  <span class="keywordflow">if</span> print_output:</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    output_array = []</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    <span class="keywordflow">while</span> <span class="keyword">True</span>:</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;      line = p.stdout.readline()</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;      <span class="keywordflow">if</span> <span class="keywordflow">not</span> line:</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;        <span class="keywordflow">break</span></div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;      <span class="keywordflow">print</span> line.strip(<span class="stringliteral">&quot;\n&quot;</span>)</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;      output_array.append(line)</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;    output = <span class="stringliteral">&quot;&quot;</span>.join(output_array)</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;  <span class="keywordflow">else</span>:</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;    output = p.stdout.read()</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;  p.wait()</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;  errout = p.stderr.read()</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;  <span class="keywordflow">if</span> print_output <span class="keywordflow">and</span> errout:</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    <span class="keywordflow">print</span> &gt;&gt;sys.stderr, errout</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;  p.stdout.close()</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;  p.stderr.close()</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;  <span class="keywordflow">return</span> output, p.returncode</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;</div></div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a9dd260785ca4cc97e245234811ef1949"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def upload.SplitPatch </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>data</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Splits a patch into separate pieces for each file.

Args:
  data: A string containing the output of svn diff.

Returns:
  A list of 2-tuple (filename, text) where text is the svn diff output
    pertaining to filename.
</pre> <div class="fragment"><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;<span class="keyword">def </span><a class="code" href="namespaceupload.html#a9dd260785ca4cc97e245234811ef1949">SplitPatch</a>(data):</div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;  <span class="stringliteral">&quot;&quot;&quot;Splits a patch into separate pieces for each file.</span></div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;<span class="stringliteral">  Args:</span></div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;<span class="stringliteral">    data: A string containing the output of svn diff.</span></div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;<span class="stringliteral">  Returns:</span></div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;<span class="stringliteral">    A list of 2-tuple (filename, text) where text is the svn diff output</span></div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;<span class="stringliteral">      pertaining to filename.</span></div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;<span class="stringliteral">  &quot;&quot;&quot;</span></div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;  patches = []</div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;  filename = <span class="keywordtype">None</span></div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;  diff = []</div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;  <span class="keywordflow">for</span> line <span class="keywordflow">in</span> data.splitlines(<span class="keyword">True</span>):</div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;    new_filename = <span class="keywordtype">None</span></div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;    <span class="keywordflow">if</span> line.startswith(<span class="stringliteral">&#39;Index:&#39;</span>):</div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;      unused, new_filename = line.split(<span class="stringliteral">&#39;:&#39;</span>, 1)</div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;      new_filename = new_filename.strip()</div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;    <span class="keywordflow">elif</span> line.startswith(<span class="stringliteral">&#39;Property changes on:&#39;</span>):</div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;      unused, temp_filename = line.split(<span class="stringliteral">&#39;:&#39;</span>, 1)</div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;      <span class="comment"># When a file is modified, paths use &#39;/&#39; between directories, however</span></div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;      <span class="comment"># when a property is modified &#39;\&#39; is used on Windows.  Make them the same</span></div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;      <span class="comment"># otherwise the file shows up twice.</span></div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;      temp_filename = temp_filename.strip().replace(<span class="stringliteral">&#39;\\&#39;</span>, <span class="stringliteral">&#39;/&#39;</span>)</div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;      <span class="keywordflow">if</span> temp_filename != filename:</div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;        <span class="comment"># File has property changes but no modifications, create a new diff.</span></div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;        new_filename = temp_filename</div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;    <span class="keywordflow">if</span> new_filename:</div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;      <span class="keywordflow">if</span> filename <span class="keywordflow">and</span> diff:</div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;        patches.append((filename, <span class="stringliteral">&#39;&#39;</span>.join(diff)))</div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;      filename = new_filename</div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;      diff = [line]</div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;      <span class="keywordflow">continue</span></div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;    <span class="keywordflow">if</span> diff <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;      diff.append(line)</div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;  <span class="keywordflow">if</span> filename <span class="keywordflow">and</span> diff:</div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;    patches.append((filename, <span class="stringliteral">&#39;&#39;</span>.join(diff)))</div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;  <span class="keywordflow">return</span> patches</div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;</div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;</div><div class="ttc" id="namespaceupload_html_a9dd260785ca4cc97e245234811ef1949"><div class="ttname"><a href="namespaceupload.html#a9dd260785ca4cc97e245234811ef1949">upload.SplitPatch</a></div><div class="ttdeci">def SplitPatch(data)</div><div class="ttdef"><b>Definition:</b> upload.py:1141</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a79ce84c196c018f3b0c7ff7a9b626b58"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def upload.StatusUpdate </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>msg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Print a status message to stdout.

If 'verbosity' is greater than 0, print the message.

Args:
  msg: The string to print.
</pre> <div class="fragment"><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="keyword">def </span><a class="code" href="namespaceupload.html#a79ce84c196c018f3b0c7ff7a9b626b58">StatusUpdate</a>(msg):</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  <span class="stringliteral">&quot;&quot;&quot;Print a status message to stdout.</span></div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="stringliteral">  If &#39;verbosity&#39; is greater than 0, print the message.</span></div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="stringliteral">  Args:</span></div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="stringliteral">    msg: The string to print.</span></div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="stringliteral">  &quot;&quot;&quot;</span></div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  <span class="keywordflow">if</span> verbosity &gt; 0:</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <span class="keywordflow">print</span> msg</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;</div><div class="ttc" id="namespaceupload_html_a79ce84c196c018f3b0c7ff7a9b626b58"><div class="ttname"><a href="namespaceupload.html#a79ce84c196c018f3b0c7ff7a9b626b58">upload.StatusUpdate</a></div><div class="ttdeci">def StatusUpdate(msg)</div><div class="ttdef"><b>Definition:</b> upload.py:97</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a7ec83cb7f7bfb9109c19b6f91552b3ee"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def upload.UploadSeparatePatches </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>issue</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>rpc_server</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>patchset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>options</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Uploads a separate patch for each file in the diff output.

Returns a list of [patch_key, filename] for each file.
</pre> <div class="fragment"><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;<span class="keyword">def </span><a class="code" href="namespaceupload.html#a7ec83cb7f7bfb9109c19b6f91552b3ee">UploadSeparatePatches</a>(issue, rpc_server, patchset, data, options):</div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;  <span class="stringliteral">&quot;&quot;&quot;Uploads a separate patch for each file in the diff output.</span></div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;<span class="stringliteral">  Returns a list of [patch_key, filename] for each file.</span></div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;<span class="stringliteral">  &quot;&quot;&quot;</span></div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;  patches = <a class="code" href="namespaceupload.html#a9dd260785ca4cc97e245234811ef1949">SplitPatch</a>(data)</div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;  rv = []</div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;  <span class="keywordflow">for</span> patch <span class="keywordflow">in</span> patches:</div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;    <span class="keywordflow">if</span> len(patch[1]) &gt; MAX_UPLOAD_SIZE:</div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;      <span class="keywordflow">print</span> (<span class="stringliteral">&quot;Not uploading the patch for &quot;</span> + patch[0] +</div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;             <span class="stringliteral">&quot; because the file is too large.&quot;</span>)</div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;      <span class="keywordflow">continue</span></div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;    form_fields = [(<span class="stringliteral">&quot;filename&quot;</span>, patch[0])]</div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;    <span class="keywordflow">if</span> <span class="keywordflow">not</span> options.download_base:</div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;      form_fields.append((<span class="stringliteral">&quot;content_upload&quot;</span>, <span class="stringliteral">&quot;1&quot;</span>))</div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;    files = [(<span class="stringliteral">&quot;data&quot;</span>, <span class="stringliteral">&quot;data.diff&quot;</span>, patch[1])]</div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;    ctype, body = <a class="code" href="namespaceupload.html#ae12985a2c860c124c502dd2099b702eb">EncodeMultipartFormData</a>(form_fields, files)</div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;    url = <span class="stringliteral">&quot;/%d/upload_patch/%d&quot;</span> % (int(issue), int(patchset))</div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;    <span class="keywordflow">print</span> <span class="stringliteral">&quot;Uploading patch for &quot;</span> + patch[0]</div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;    response_body = rpc_server.Send(url, body, content_type=ctype)</div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;    lines = response_body.splitlines()</div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;    <span class="keywordflow">if</span> <span class="keywordflow">not</span> lines <span class="keywordflow">or</span> lines[0] != <span class="stringliteral">&quot;OK&quot;</span>:</div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;      <a class="code" href="namespaceupload.html#a79ce84c196c018f3b0c7ff7a9b626b58">StatusUpdate</a>(<span class="stringliteral">&quot;  --&gt; %s&quot;</span> % response_body)</div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;      sys.exit(1)</div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;    rv.append([lines[1], patch[0]])</div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;  <span class="keywordflow">return</span> rv</div><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;</div><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;</div><div class="ttc" id="namespaceupload_html_a7ec83cb7f7bfb9109c19b6f91552b3ee"><div class="ttname"><a href="namespaceupload.html#a7ec83cb7f7bfb9109c19b6f91552b3ee">upload.UploadSeparatePatches</a></div><div class="ttdeci">def UploadSeparatePatches(issue, rpc_server, patchset, data, options)</div><div class="ttdef"><b>Definition:</b> upload.py:1181</div></div>
<div class="ttc" id="namespaceupload_html_a9dd260785ca4cc97e245234811ef1949"><div class="ttname"><a href="namespaceupload.html#a9dd260785ca4cc97e245234811ef1949">upload.SplitPatch</a></div><div class="ttdeci">def SplitPatch(data)</div><div class="ttdef"><b>Definition:</b> upload.py:1141</div></div>
<div class="ttc" id="namespaceupload_html_ae12985a2c860c124c502dd2099b702eb"><div class="ttname"><a href="namespaceupload.html#ae12985a2c860c124c502dd2099b702eb">upload.EncodeMultipartFormData</a></div><div class="ttdeci">def EncodeMultipartFormData(fields, files)</div><div class="ttdef"><b>Definition:</b> upload.py:498</div></div>
<div class="ttc" id="namespaceupload_html_a79ce84c196c018f3b0c7ff7a9b626b58"><div class="ttname"><a href="namespaceupload.html#a79ce84c196c018f3b0c7ff7a9b626b58">upload.StatusUpdate</a></div><div class="ttdeci">def StatusUpdate(msg)</div><div class="ttdef"><b>Definition:</b> upload.py:97</div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a class="anchor" id="a675d13c979f1c720866d22ed1736f580"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">upload.action</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a985aa9a71de3eb507344df65700c696d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">upload.const</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="af4be925d9a50d5ad134d86400509d0f2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">upload.default</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a770d9c7b49b1fede80de6078d5e49af7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">upload.dest</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a9d33d66de17175dced88ffe95f079226"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">upload.group = parser.add_option_group(&quot;Logging options&quot;)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="abfc23c9aa2d9b777678da117a85929a5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">upload.help</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="aad5b1a43823e2a710a2f78e33dde8901"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int upload.MAX_UPLOAD_SIZE = 900</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="af1cea8af5389f0ab2d8b65b2c0fd2fe0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">upload.metavar</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="af9e508d19dc2dd9cdb7c642dde0bdd21"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">upload.parser = optparse.OptionParser(usage=&quot;%prog [options] [-- diff_options]&quot;)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a4fc56f0dd6613be15c3c4dc3af3619ce"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">upload.type</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="afa85ceef00a65cd276a856404eb5f310"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">upload.use_shell = sys.platform.startswith(&quot;win&quot;)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a79aff46409a98c4e5f608c8df1fd4612"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int upload.verbosity = 1</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
